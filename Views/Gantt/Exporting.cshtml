@using Syncfusion.EJ2.Gantt;
@section ControlsSection{
    <div class="control-section">
        <div class="row">
            <div class="col-md-12">
                <ejs-gantt id='Exporting' dataSource="ViewBag.dataSource" gridLines="Both"
                           treeColumnIndex="1" height="450px" toolbarClick="toolbarClick"
                           allowExcelExport="true" allowSelection="true" highlightWeekends="true"
                           resources="ViewBag.projectResources" resourceIDMapping="ResourceId" resourceNameMapping="ResourceName"
                           projectStartDate="03/25/2019" projectEndDate="07/28/2019"
                           toolbar="@(new List<string>() { "ExcelExport", "CsvExport" })">
                    <e-gantt-taskfields id="TaskId" name="TaskName" startDate="StartDate"
                                        endDate="EndDate" duration="Duration" progress="Progress" dependency="Predecessor"
                                        child="SubTasks" resourceInfo="ResourceId">
                    </e-gantt-taskfields>
                    <e-gantt-timelinesettings>
                        <e-timelinesettings-toptier unit="Week" format="MMM dd, y"></e-timelinesettings-toptier>
                        <e-timelinesettings-bottomtier unit="Day"></e-timelinesettings-bottomtier>
                    </e-gantt-timelinesettings>
                    <e-gantt-labelSettings leftLabel="TaskName" rightLabel="${if(taskData.SubTasks)}${taskData.Duration} ${else if(ResourceId)}${ResourceId}${/if}"></e-gantt-labelSettings>
                </ejs-gantt>
            </div>
        </div>
    </div>
    <script>
        function toolbarClick(args) {
            var ganttObj = document.getElementById("Exporting").ej2_instances[0];
            if (args.item.id === 'Exporting_excelexport') {
                ganttObj.excelExport();
            }
            else if (args.item.id === 'Exporting_csvexport') {
                ganttObj.csvExport();
            }
        }
    </script>
}

@section ActionDescription{
    <div id="action-description">
        <p>This sample demonstrates client-side exporting of the Gantt, which allows you to export Gantt data to Excel and CSV formats. Using the Gantt toolbar buttons, you can export Gantt data to the desired format. </p>
    </div>

}
@section Description{
    <div id="description">
        <p>Gantt supports client-side exporting, which allows you to export its data to the Excel and CSV formats. </p>
        <p>In this demo, we have defined actions in the <code>toolbarClick</code> event to export the Gantt data using the <code>excelExport</code> and <code>csvExport</code> methods.</p>       
    </div>
}
@section Meta{
    <meta name="description" content="This demo explains how to export Gantt content to Excel and CSV documents using the Syncfusion TypeScript Gantt control." />
}